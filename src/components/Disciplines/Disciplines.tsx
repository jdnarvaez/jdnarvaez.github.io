import { useMemo, useRef, useLayoutEffect, useEffect } from 'react';

import { animate, motion, MotionValue, useCycle, useMotionValue } from 'framer-motion';

// @ts-ignore
import { interpolate } from 'flubber';
import { useAnimationFrame } from '../../hooks/useAnimationFrame';

function useSVGMorph(d: string, config = {}) {
  const value = useMotionValue(d);

  useEffect(() => {
    const interpolator = interpolate(value.get(), d);

    animate(0, 1, {
      ...config,
      onUpdate: (progress) => value.set(interpolator(progress)),
    });
  }, [config, d, value]);

  return value;
}

const A = {
  key: 'A',
  path: 'M 157.2480005493164 124.19100189208984 L 181.61400054931642 124.19100189208984 L 181.61400054931642 123.14300189208984 C 179.5180005493164 121.83300189208984 179.1250005493164 118.82000189208985 179.1250005493164 113.18700189208984 L 179.1250005493164 79.78200189208985 C 179.1250005493164 70.87400189208984 175.7190005493164 64.06200189208984 168.7760005493164 59.739001892089846 C 163.6670005493164 56.59500189208984 157.1170005493164 55.28500189208984 146.8990005493164 55.28500189208984 C 125.9390005493164 55.28500189208984 115.7210005493164 66.15800189208984 115.19700054931641 79.38900189208985 L 138.6460005493164 79.38900189208985 C 139.3010005493164 74.54200189208984 142.0520005493164 71.39800189208984 147.4230005493164 71.39800189208984 C 152.79400054931642 71.39800189208984 154.4970005493164 74.14900189208984 154.4970005493164 77.81700189208985 C 154.4970005493164 82.00900189208984 150.69800054931642 83.71200189208984 136.5500005493164 85.28400189208983 C 123.7120005493164 86.72500189208984 112.31500054931641 91.04800189208984 112.31500054931641 105.85100189208984 C 112.31500054931641 118.95100189208985 121.74700054931641 125.89400189208985 134.58500054931642 125.89400189208985 C 143.2310005493164 125.89400189208985 150.30500054931642 123.01200189208984 154.7590005493164 116.85500189208985 L 155.0210005493164 116.85500189208985 C 155.5450005493164 120.52300189208984 156.3310005493164 122.61900189208984 157.2480005493164 124.19100189208984 Z M 143.8860005493164 111.22200189208985 C 139.8250005493164 111.22200189208985 136.15700054931642 109.25700189208985 136.15700054931642 104.80300189208984 C 136.15700054931642 100.87300189208985 138.3840005493164 98.77700189208984 145.5890005493164 97.20500189208984 C 149.78100054931642 96.28800189208984 152.79400054931642 95.24000189208985 155.1520005493164 94.06100189208985 L 155.1520005493164 99.95600189208984 C 155.1520005493164 107.94700189208984 149.65000054931642 111.22200189208985 143.8860005493164 111.22200189208985 Z',
  width: 65,
};

const I = {
  key: 'I',
  path: 'M 115.328 124.191 L 140.087 124.191 L 140.087 57.381 L 115.328 57.381 L 115.328 124.191 Z',
  width: 27,
};

const D = {
  key: 'D',
  path: 'M 142.7070005493164 126.41800189208985 C 150.96000054931642 126.41800189208985 158.0340005493164 122.35700189208984 162.3570005493164 114.89000189208984 L 162.6190005493164 114.89000189208984 L 162.6190005493164 124.19100189208984 L 186.1990005493164 124.19100189208984 L 186.1990005493164 30.526001892089837 L 161.4400005493164 30.526001892089837 L 161.4400005493164 64.45500189208984 L 161.0470005493164 64.45500189208984 C 156.7240005493164 58.822001892089844 152.00800054931642 55.28500189208984 142.4450005493164 55.28500189208984 C 124.6290005493164 55.28500189208984 112.57700054931641 69.69500189208983 112.57700054931641 90.65500189208984 C 112.57700054931641 113.71100189208984 125.4150005493164 126.41800189208985 142.7070005493164 126.41800189208985 Z M 149.78100054931642 107.68500189208984 C 142.4450005493164 107.68500189208984 137.7290005493164 100.48000189208985 137.7290005493164 90.26200189208984 C 137.7290005493164 80.04400189208985 142.5760005493164 73.10100189208984 149.78100054931642 73.10100189208984 C 157.1170005493164 73.10100189208984 162.0950005493164 80.69900189208984 162.0950005493164 90.26200189208984 C 162.0950005493164 99.95600189208984 157.1170005493164 107.68500189208984 149.78100054931642 107.68500189208984 Z',
  width: 60,
};

const E = {
  key: 'E',
  path: 'M 149.12600054931642 126.02500189208985 C 157.6410005493164 126.02500189208985 164.3220005493164 124.32200189208984 170.47900054931642 120.39200189208984 C 177.0290005493164 116.20000189208984 181.74500054931642 110.30500189208985 183.18600054931642 104.27900189208984 L 159.2130005493164 104.27900189208984 C 157.3790005493164 107.55400189208984 154.2350005493164 109.25700189208985 149.91200054931642 109.25700189208985 C 142.4450005493164 109.25700189208985 138.2530005493164 104.54100189208984 136.8120005493164 96.81200189208984 L 184.49600054931642 96.81200189208984 C 184.75800054931642 83.58100189208984 180.9590005493164 71.66000189208984 172.8370005493164 64.19300189208984 C 166.68000054931642 58.56000189208984 158.6890005493164 55.15400189208984 148.2090005493164 55.15400189208984 C 127.1180005493164 55.15400189208984 112.57700054931641 70.48100189208984 112.57700054931641 90.65500189208984 C 112.57700054931641 111.09100189208985 127.2490005493164 126.02500189208985 149.12600054931642 126.02500189208985 Z M 148.73300054931642 71.79100189208984 C 154.62800054931643 71.79100189208984 158.8200005493164 76.24500189208985 159.8680005493164 83.71200189208984 L 136.8120005493164 83.71200189208984 C 138.1220005493164 76.37600189208985 141.9210005493164 71.79100189208984 148.73300054931642 71.79100189208984 Z',
  width: 65,
};

const N = {
  key: 'N',
  path: 'M 138.9080005493164 57.38100189208984 L 115.32800054931641 57.38100189208984 L 115.32800054931641 124.19100189208984 L 140.0870005493164 124.19100189208984 L 140.0870005493164 88.16600189208984 C 140.0870005493164 80.96100189208984 143.8860005493164 75.45900189208984 150.17400054931642 75.45900189208984 C 156.5930005493164 75.45900189208984 159.4750005493164 80.04400189208985 159.4750005493164 86.98700189208984 L 159.4750005493164 124.19100189208984 L 184.23400054931642 124.19100189208984 L 184.23400054931642 80.96100189208984 C 184.23400054931642 65.63400189208984 176.2430005493164 55.28500189208984 160.7850005493164 55.28500189208984 C 151.48400054931642 55.28500189208984 144.6720005493164 59.215001892089845 139.3010005493164 66.55100189208984 L 138.9080005493164 66.55100189208984 Z',
  width: 70,
};

const L = {
  key: 'L',
  path: 'M 115.32800054931641 124.19100189208984 L 140.7420005493164 124.19100189208984 L 140.7420005493164 30.526001892089837 L 115.32800054931641 30.526001892089837 Z',
  width: 28,
};

const P = {
  key: 'P',
  path: 'M 115.32800054931641 146.33000189208985 L 140.0870005493164 146.33000189208985 L 140.0870005493164 117.90300189208985 L 140.4800005493164 117.90300189208985 C 144.9340005493164 123.40500189208984 151.0910005493164 126.41800189208985 159.0820005493164 126.41800189208985 C 176.8980005493164 126.41800189208985 188.42600054931643 112.53200189208984 188.42600054931643 90.65500189208984 C 188.42600054931643 71.26700189208984 178.0770005493164 55.28500189208984 160.1300005493164 55.28500189208984 C 150.96000054931642 55.28500189208984 144.1480005493164 58.953001892089844 139.3010005493164 65.24100189208984 L 138.9080005493164 65.24100189208984 L 138.9080005493164 57.38100189208984 L 115.32800054931641 57.38100189208984 Z M 151.74600054931642 108.20900189208984 C 144.1480005493164 108.20900189208984 139.1700005493164 101.39700189208985 139.1700005493164 91.70300189208984 C 139.1700005493164 82.14000189208984 144.1480005493164 75.06600189208984 151.74600054931642 75.06600189208984 C 159.0820005493164 75.06600189208984 163.2740005493164 81.48500189208984 163.2740005493164 91.70300189208984 C 163.2740005493164 101.92100189208985 159.0820005493164 108.20900189208984 151.74600054931642 108.20900189208984 Z',
  width: 65,
};

const R = {
  key: 'R',
  path: 'M 138.9080005493164 57.38100189208984 L 115.32800054931641 57.38100189208984 L 115.32800054931641 124.19100189208984 L 140.0870005493164 124.19100189208984 L 140.0870005493164 96.81200189208984 C 140.0870005493164 81.74700189208984 148.60200054931641 75.19700189208984 163.1430005493164 77.68600189208985 L 163.6670005493164 77.68600189208985 L 163.6670005493164 56.59500189208984 C 162.8810005493164 56.20200189208984 161.5710005493164 55.94000189208984 159.6060005493164 55.94000189208984 C 151.0910005493164 55.94000189208984 144.6720005493164 59.084001892089844 139.3010005493164 67.46800189208984 L 138.9080005493164 67.46800189208984 Z',
  width: 45,
};

const V = {
  key: 'V',
  path: 'M 132.88200054931642 124.19100189208984 L 161.8330005493164 124.19100189208984 L 184.75800054931642 57.38100189208984 L 159.8680005493164 57.38100189208984 L 152.27000054931642 83.05700189208984 C 150.30500054931642 89.86900189208984 147.8160005493164 99.17000189208984 147.8160005493164 99.17000189208984 L 147.5540005493164 99.17000189208984 C 147.5540005493164 99.17000189208984 145.1960005493164 89.86900189208984 143.2310005493164 83.05700189208984 L 135.63300054931642 57.38100189208984 L 109.9570005493164 57.38100189208984 Z',
  width: 65,
};

const G = {
  key: 'G',
  path: 'M 148.0780005493164 147.50900189208986 C 158.0340005493164 147.50900189208986 166.81100054931642 145.41300189208985 172.9680005493164 140.17300189208984 C 178.8630005493164 135.19500189208983 182.7930005493164 126.94200189208985 182.7930005493164 116.20000189208984 L 182.7930005493164 57.38100189208984 L 159.2130005493164 57.38100189208984 L 159.2130005493164 64.71700189208984 L 158.8200005493164 64.71700189208984 C 155.0210005493164 58.953001892089844 149.25700054931642 55.28500189208984 139.8250005493164 55.28500189208984 C 123.4500005493164 55.28500189208984 112.57700054931641 70.21900189208984 112.57700054931641 89.34500189208984 C 112.57700054931641 110.30500189208985 125.8080005493164 120.91600189208984 141.0040005493164 120.91600189208984 C 148.73300054931642 120.91600189208984 153.9730005493164 117.77200189208985 157.9030005493164 113.31800189208984 L 158.4270005493164 113.31800189208984 L 158.4270005493164 119.34400189208985 C 158.4270005493164 126.28700189208985 155.6760005493164 131.00300189208986 147.6850005493164 131.00300189208986 C 141.7900005493164 131.00300189208986 138.6460005493164 128.12100189208985 137.7290005493164 125.37000189208985 L 113.88700054931641 125.37000189208985 C 116.2450005493164 140.17300189208984 129.3450005493164 147.50900189208986 148.0780005493164 147.50900189208986 Z M 148.0780005493164 103.62400189208984 C 141.1350005493164 103.62400189208984 136.68100054931642 97.20500189208984 136.68100054931642 88.29700189208984 C 136.68100054931642 79.25800189208985 141.1350005493164 73.23200189208984 148.0780005493164 73.23200189208984 C 155.2830005493164 73.23200189208984 159.4750005493164 79.91300189208985 159.4750005493164 88.29700189208984 C 159.4750005493164 97.07400189208984 155.2830005493164 103.62400189208984 148.0780005493164 103.62400189208984 Z',
  width: 70,
};

const O = {
  key: 'O',
  path: 'M 149.25700054931642 126.28700189208985 C 171.52700054931643 126.28700189208985 185.6750005493164 111.22200189208985 185.6750005493164 90.91700189208984 C 185.6750005493164 70.61200189208984 171.52700054931643 55.41600189208984 149.25700054931642 55.41600189208984 C 126.9870005493164 55.41600189208984 112.57700054931641 70.61200189208984 112.57700054931641 90.91700189208984 C 112.57700054931641 111.22200189208985 126.9870005493164 126.28700189208985 149.25700054931642 126.28700189208985 Z M 148.99500054931642 109.78100189208985 C 141.3970005493164 109.78100189208985 137.7290005493164 102.18300189208983 137.7290005493164 90.91700189208984 C 137.7290005493164 79.65100189208985 141.3970005493164 72.05300189208984 148.99500054931642 72.05300189208984 C 156.5930005493164 72.05300189208984 160.5230005493164 79.65100189208985 160.5230005493164 90.91700189208984 C 160.5230005493164 102.18300189208983 156.5930005493164 109.78100189208985 148.99500054931642 109.78100189208985 Z',
  width: 65,
};

const S = {
  key: 'S',
  path: 'M 145.0650005493164 126.41800189208985 C 163.4050005493164 126.41800189208985 177.9460005493164 119.47500189208985 177.9460005493164 103.49300189208984 C 177.9460005493164 84.89100189208983 162.4880005493164 82.14000189208984 150.30500054931642 80.43700189208984 C 142.7070005493164 79.38900189208985 136.5500005493164 78.60300189208985 136.5500005493164 74.80400189208984 C 136.5500005493164 71.39800189208984 139.9560005493164 69.95700189208983 143.6240005493164 69.95700189208983 C 147.6850005493164 69.95700189208983 151.3530005493164 71.00500189208984 152.00800054931642 75.98300189208985 L 175.3260005493164 75.98300189208985 C 174.4090005493164 62.883001892089844 163.7980005493164 55.28500189208984 143.4930005493164 55.28500189208984 C 127.1180005493164 55.28500189208984 113.10100054931641 62.883001892089844 113.10100054931641 76.63800189208985 C 113.10100054931641 93.40600189208985 126.0700005493164 96.41900189208984 137.3360005493164 98.12200189208984 C 145.9820005493164 99.43200189208984 153.7110005493164 100.08700189208984 153.7110005493164 105.58900189208984 C 153.7110005493164 109.65000189208985 150.04300054931642 111.35300189208985 145.1960005493164 111.35300189208985 C 138.9080005493164 111.35300189208985 135.5020005493164 108.07800189208984 135.10900054931642 102.57600189208983 L 111.39800054931641 102.57600189208983 C 111.52900054931641 117.90300189208985 125.2840005493164 126.41800189208985 145.0650005493164 126.41800189208985 Z',
  width: 60,
};

const T = {
  key: 'T',
  path: 'M 111.79100054931641 72.31500189208984 L 120.43700054931641 72.31500189208984 L 120.43700054931641 104.93400189208984 C 120.43700054931641 120.91600189208984 128.6900005493164 125.50100189208985 144.9340005493164 125.50100189208985 C 149.38800054931642 125.50100189208985 153.31800054931642 124.84600189208984 157.1170005493164 123.92900189208984 L 157.1170005493164 105.72000189208984 C 149.38800054931642 106.24400189208984 144.6720005493164 106.11300189208984 144.6720005493164 99.43200189208984 L 144.6720005493164 72.31500189208984 L 157.3790005493164 72.31500189208984 L 157.3790005493164 57.38100189208984 L 144.6720005493164 57.38100189208984 L 144.6720005493164 35.76600189208985 L 120.43700054931641 35.76600189208985 L 120.43700054931641 57.38100189208984 L 111.79100054931641 57.38100189208984 Z',
  width: 44,
};

const U = {
  key: 'U',
  path: 'M 183.44800054931642 124.19100189208984 L 183.44800054931642 57.38100189208984 L 158.6890005493164 57.38100189208984 L 158.6890005493164 93.40600189208985 C 158.6890005493164 100.61100189208985 154.89000054931643 105.19600189208984 148.47100054931641 105.19600189208984 C 142.5760005493164 105.19600189208984 139.5630005493164 101.52800189208985 139.5630005493164 94.58500189208985 L 139.5630005493164 57.38100189208984 L 114.80400054931641 57.38100189208984 L 114.80400054931641 100.48000189208985 C 114.80400054931641 115.80700189208984 122.66400054931641 126.28700189208985 138.6460005493164 126.28700189208985 C 147.8160005493164 126.28700189208985 154.36600054931642 122.48800189208984 159.4750005493164 115.54500189208984 L 159.8680005493164 115.54500189208984 L 159.8680005493164 124.19100189208984 Z',
  width: 65,
};

const DOT = {
  path: 'M 24.339 14.462 C 24.339 21.162 18.908 26.595 12.207 26.595 C 5.506 26.595 0.074 21.162 0.074 14.462 C 0.074 7.761 5.506 2.328 12.207 2.328 C 18.908 2.328 24.339 7.761 24.339 14.462 Z',
};

const SPACE = {
  key: 'SPACE',
  path: 'M 0 0',
  width: 0,
};

export const Disciplines = () => {
  const [shapes, cycleShapes] = useCycle(
    [D, E, V, E, L, O, P, E, R, SPACE, SPACE],
    [E, N, G, I, N, E, E, R, SPACE, SPACE, SPACE],
    [D, E, S, I, G, N, E, R, SPACE, SPACE, SPACE],
    [I, L, L, U, S, T, R, A, T, O, R]
  );

  useAnimationFrame({
    callback: () => {
      cycleShapes();
    },
    requestedFPS: 0.5,
    delay: 1.5,
  });

  const paths = shapes.map(({ path, width, key }) => {
    return { path: useSVGMorph(path, { duration: 0.5 }), width, key };
  });

  const getOffset = (idx: number) => {
    if (idx === -1) {
      return innerWidth;
    }

    var offset = 0;

    for (var i = 0; i < idx; i++) {
      offset += paths[i].width;
    }

    return offset;
  };

  // @ts-ignore
  const hasI = paths.indexOf(paths.find((p) => p.key === 'I'));

  return (
    <svg
      viewBox="100 0 824 163"
      xmlns="http://www.w3.org/2000/svg"
      style={{
        stroke: 'var(--primary-text)',
        strokeWidth: 1,
        strokeLinecap: 'round',
        fill: 'var(--primary-text)',
      }}
    >
      <g
        style={{ transition: 'all .5s linear' }}
        transform={`translate(${getOffset(hasI) + 115}, 27)`}
      >
        <motion.path fill={'var(--volt)'} stroke={'var(--volt)'} d={DOT.path} initial={false} />
      </g>
      {paths.map(({ path, key }, idx) => (
        <g
          key={`${key}-${idx}`}
          style={{ transition: 'all .5s linear' }}
          transform={`translate(${getOffset(idx)}, 0)`}
        >
          <motion.path d={path} />
        </g>
      ))}
    </svg>
  );
};
